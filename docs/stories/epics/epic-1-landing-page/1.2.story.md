# Story 1.2 — Integração Analytics

**Épico:** EPIC-1 (Landing Page)
**Status:** Ready
**Pontos:** 3
**Requisito:** NFR-006

## Executor Assignment
- **executor:** @dev
- **quality_gate:** @architect
- **quality_gate_tools:** [GA4 DebugView, Meta Pixel Helper, Lighthouse]

## Dependencies
- **Story 1.7** (LGPD) — Consent banner deve estar implementado antes de disparar analytics

---

## User Story
**Como** dono do produto,
**Eu quero** rastrear o comportamento dos visitantes na landing page,
**Para que** eu possa tomar decisões baseadas em dados e otimizar a conversão.

## Acceptance Criteria

- [ ] **AC-1:** Google Analytics 4 (GA4) integrado e coletando dados de pageview
- [ ] **AC-2:** Meta Pixel integrado e rastreando visitas
- [ ] **AC-3:** Eventos customizados configurados: clique em CTA "Começar Agora", clique em "Ver Planos", seleção de plano, scroll depth (25%, 50%, 75%, 100%)
- [ ] **AC-4:** Conversão de formulário trackada como evento no GA4 e como Custom Conversion no Meta
- [ ] **AC-5:** UTM parameters são capturados e armazenados
- [ ] **AC-6:** Scripts de analytics carregam de forma assíncrona (não bloqueiam renderização)
- [ ] **AC-7:** Consent banner para LGPD (analytics só dispara após consentimento)

## Scope

### IN
- Google Analytics 4 setup
- Meta Pixel setup
- Event tracking (cliques, scroll, formulários)
- UTM tracking
- Consent banner (LGPD)

### OUT
- Google Tag Manager (simplificar com integração direta)
- Dashboards customizados no GA4
- Relatórios automatizados

## Tasks
- [ ] Criar conta GA4 e obter Measurement ID
- [ ] Adicionar script GA4 ao index.html (async)
- [ ] Criar Meta Pixel e adicionar ao index.html (async)
- [ ] Implementar event tracking em JavaScript (cliques CTAs, scroll)
- [ ] Implementar captura de UTM parameters
- [ ] Criar consent banner para LGPD
- [ ] Condicionar disparo de analytics ao consentimento

## File List
- [ ] `index.html` — Scripts GA4 e Meta Pixel
- [ ] `js/analytics.js` — Novo: lógica de event tracking
- [ ] `js/consent.js` — Novo: consent banner LGPD
- [ ] `css/style.css` — Estilos do consent banner

## Risks
- Scripts de analytics podem impactar performance (Lighthouse score)
- LGPD exige consentimento antes de tracking — implementar consent-first
- GA4 e Meta Pixel podem conflitar se não configurados corretamente

## Definition of Done
- [ ] Todas as ACs verificadas e aprovadas
- [ ] GA4 recebendo dados no DebugView
- [ ] Meta Pixel validado via Pixel Helper extension
- [ ] Consent banner funcional (analytics só dispara após aceite)
- [ ] Performance não degradada (Lighthouse >= 85)

## CodeRabbit Integration
> **CodeRabbit Integration**: Disabled
>
> CodeRabbit CLI is not enabled in `core-config.yaml`.
> Quality validation will use manual review process only.

## Testing
- Verificar eventos no GA4 DebugView (cliques, scroll, conversão)
- Verificar eventos no Meta Events Manager
- Testar consent banner: recusar → verificar que analytics NÃO dispara
- Testar consent banner: aceitar → verificar que analytics dispara
- Testar UTM params: acessar com ?utm_source=test e verificar captura

## Change Log
| Data | Autor | Mudança |
|------|-------|---------|
| 2026-02-17 | @pm | Story criada |
| 2026-02-17 | @po | Validada — GO. Adicionadas seções obrigatórias, dependência com 1.7 |

## Dev Agent Record
*Preenchido pelo @dev durante implementação*

## QA Results
*Preenchido pelo @qa durante review*
